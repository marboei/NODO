{"ast":null,"code":"import { BEGIN_DRAG, PUBLISH_DRAG_SOURCE, HOVER, END_DRAG, DROP } from '../actions/dragDrop/index.mjs';\nimport { ADD_SOURCE, ADD_TARGET, REMOVE_SOURCE, REMOVE_TARGET } from '../actions/registry.mjs';\nimport { areArraysEqual } from '../utils/equality.mjs';\nimport { NONE, ALL } from '../utils/dirtiness.mjs';\nimport { xor } from '../utils/js_utils.mjs';\nexport function reduce() {\n  let _state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : NONE;\n\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case HOVER:\n      break;\n\n    case ADD_SOURCE:\n    case ADD_TARGET:\n    case REMOVE_TARGET:\n    case REMOVE_SOURCE:\n      return NONE;\n\n    case BEGIN_DRAG:\n    case PUBLISH_DRAG_SOURCE:\n    case END_DRAG:\n    case DROP:\n    default:\n      return ALL;\n  }\n\n  const {\n    targetIds = [],\n    prevTargetIds = []\n  } = action.payload;\n  const result = xor(targetIds, prevTargetIds);\n  const didChange = result.length > 0 || !areArraysEqual(targetIds, prevTargetIds);\n\n  if (!didChange) {\n    return NONE;\n  } // Check the target ids at the innermost position. If they are valid, add them\n  // to the result\n\n\n  const prevInnermostTargetId = prevTargetIds[prevTargetIds.length - 1];\n  const innermostTargetId = targetIds[targetIds.length - 1];\n\n  if (prevInnermostTargetId !== innermostTargetId) {\n    if (prevInnermostTargetId) {\n      result.push(prevInnermostTargetId);\n    }\n\n    if (innermostTargetId) {\n      result.push(innermostTargetId);\n    }\n  }\n\n  return result;\n}","map":{"version":3,"mappings":"AAAA,SACCA,UADD,EAECC,mBAFD,EAGCC,KAHD,EAICC,QAJD,EAKCC,IALD,QAMO,+BANP;AAOA,SACCC,UADD,EAECC,UAFD,EAGCC,aAHD,EAICC,aAJD,QAKO,yBALP;AAOA,SAASC,cAAT,QAA+B,uBAA/B;AACA,SAASC,IAAT,EAAeC,GAAf,QAA0B,wBAA1B;AACA,SAASC,GAAT,QAAoB,uBAApB;AASA,OAAM,SAAUC,MAAV,GAIG;AAAA,MAFRC,MAEQ,uEAFQJ,IAER;;AAAA,MADRK,MACQ;;AACR,UAAQA,MAAM,CAACC,IAAf;AACC,SAAKd,KAAL;AACC;;AACD,SAAKG,UAAL;AACA,SAAKC,UAAL;AACA,SAAKE,aAAL;AACA,SAAKD,aAAL;AACC,aAAOG,IAAP;;AACD,SAAKV,UAAL;AACA,SAAKC,mBAAL;AACA,SAAKE,QAAL;AACA,SAAKC,IAAL;;AAEC,aAAOO,GAAP;AAbF;;AAgBA,QAAM;AAAEM,aAAS,GAAG,EAAd;AAAkBC,iBAAa,GAAG;AAAlC,MAAyCH,MAAM,CAACI,OAAtD;AACA,QAAMC,MAAM,GAAGR,GAAG,CAACK,SAAD,EAAYC,aAAZ,CAAlB;AACA,QAAMG,SAAS,GACdD,MAAM,CAACE,MAAPF,GAAgB,CAAhBA,IAAiB,CAAKX,cAAc,CAACQ,SAAD,EAAYC,aAAZ,CADrC;;AAGA,MAAE,CAAGG,SAAL,EAAgB;AACf,WAAOX,IAAP;AACA,GAxBO,CA0BR;AACA;;;AACA,QAAMa,qBAAqB,GAAGL,aAAa,CAACA,aAAa,CAACI,MAAdJ,GAAuB,CAAxB,CAA3C;AACA,QAAMM,iBAAiB,GAAGP,SAAS,CAACA,SAAS,CAACK,MAAVL,GAAmB,CAApB,CAAnC;;AACA,MAAIM,qBAAqB,KAAKC,iBAA9B,EAAiD;AAChD,QAAID,qBAAJ,EAA2B;AAC1BH,YAAM,CAACK,IAAPL,CAAYG,qBAAZH;AACA;;AACD,QAAII,iBAAJ,EAAuB;AACtBJ,YAAM,CAACK,IAAPL,CAAYI,iBAAZJ;AACA;AACD;;AAED,SAAOA,MAAP;AACA","names":["BEGIN_DRAG","PUBLISH_DRAG_SOURCE","HOVER","END_DRAG","DROP","ADD_SOURCE","ADD_TARGET","REMOVE_SOURCE","REMOVE_TARGET","areArraysEqual","NONE","ALL","xor","reduce","_state","action","type","targetIds","prevTargetIds","payload","result","didChange","length","prevInnermostTargetId","innermostTargetId","push"],"sources":["/home/marboi/Work/dotnet/NoDo/client/node_modules/dnd-core/src/reducers/dirtyHandlerIds.ts"],"sourcesContent":["import {\n\tBEGIN_DRAG,\n\tPUBLISH_DRAG_SOURCE,\n\tHOVER,\n\tEND_DRAG,\n\tDROP,\n} from '../actions/dragDrop/index.js'\nimport {\n\tADD_SOURCE,\n\tADD_TARGET,\n\tREMOVE_SOURCE,\n\tREMOVE_TARGET,\n} from '../actions/registry.js'\nimport type { Action } from '../interfaces.js'\nimport { areArraysEqual } from '../utils/equality.js'\nimport { NONE, ALL } from '../utils/dirtiness.js'\nimport { xor } from '../utils/js_utils.js'\n\nexport type State = string[]\n\nexport interface DirtyHandlerIdPayload {\n\ttargetIds: string[]\n\tprevTargetIds: string[]\n}\n\nexport function reduce(\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t_state: State = NONE,\n\taction: Action<DirtyHandlerIdPayload>,\n): State {\n\tswitch (action.type) {\n\t\tcase HOVER:\n\t\t\tbreak\n\t\tcase ADD_SOURCE:\n\t\tcase ADD_TARGET:\n\t\tcase REMOVE_TARGET:\n\t\tcase REMOVE_SOURCE:\n\t\t\treturn NONE\n\t\tcase BEGIN_DRAG:\n\t\tcase PUBLISH_DRAG_SOURCE:\n\t\tcase END_DRAG:\n\t\tcase DROP:\n\t\tdefault:\n\t\t\treturn ALL\n\t}\n\n\tconst { targetIds = [], prevTargetIds = [] } = action.payload\n\tconst result = xor(targetIds, prevTargetIds)\n\tconst didChange =\n\t\tresult.length > 0 || !areArraysEqual(targetIds, prevTargetIds)\n\n\tif (!didChange) {\n\t\treturn NONE\n\t}\n\n\t// Check the target ids at the innermost position. If they are valid, add them\n\t// to the result\n\tconst prevInnermostTargetId = prevTargetIds[prevTargetIds.length - 1]\n\tconst innermostTargetId = targetIds[targetIds.length - 1]\n\tif (prevInnermostTargetId !== innermostTargetId) {\n\t\tif (prevInnermostTargetId) {\n\t\t\tresult.push(prevInnermostTargetId)\n\t\t}\n\t\tif (innermostTargetId) {\n\t\t\tresult.push(innermostTargetId)\n\t\t}\n\t}\n\n\treturn result\n}\n"]},"metadata":{},"sourceType":"module"}